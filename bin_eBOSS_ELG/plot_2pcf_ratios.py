import numpy as n
import matplotlib
matplotlib.use('Agg')
import matplotlib.pyplot as p


REF = n.loadtxt("ebosselg.JC28Nov2017_2pcf", unpack=True)

p.figure(1, (5,5))

DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.mask_O2O3Hb_th_1.5.txt", unpack=True)
p.plot(REF[0], DATA[1]/REF[1], label='O2O3Hb_th_1.5')
DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.mask_O2O3Hb_th_1.txt", unpack=True)
p.plot(REF[0], DATA[1]/REF[1], label='O2O3Hb_th_1')
DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.mask_O2O3Hb_th_2.txt", unpack=True)
p.plot(REF[0], DATA[1]/REF[1], label='O2O3Hb_th_2')

DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.mask_O2O3_th_1.5.txt", unpack=True)
p.plot(REF[0], DATA[1]/REF[1], label='O2O3_th_1.5')
DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.mask_O2O3_th_1.txt", unpack=True)
p.plot(REF[0], DATA[1]/REF[1], label='O2O3_th_1')
DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.mask_O2O3_th_2.txt", unpack=True)
p.plot(REF[0], DATA[1]/REF[1], label='O2O3_th_2')

DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.mask_O2_th_1.5.txt", unpack=True)
p.plot(REF[0], DATA[1]/REF[1], label='O2_th_1.5')
DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.mask_O2_th_1.txt", unpack=True)
p.plot(REF[0], DATA[1]/REF[1], label='O2_th_1')
DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.mask_O2_th_2.txt", unpack=True)
p.plot(REF[0], DATA[1]/REF[1], label='O2_th_2')

DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.O2O3Hb_th_3.txt", unpack=True)
p.plot(REF[0], DATA[1]/REF[1], label='O2O3Hb_th_3')
DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.O2O3_th_3.txt", unpack=True)
p.plot(REF[0], DATA[1]/REF[1], label='O2O3_th_3')
DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.O2_th_3.txt", unpack=True)
p.plot(REF[0], DATA[1]/REF[1], label='O2_th_3')

p.xscale('log')
p.xlabel('s Mpc/h')
p.ylabel('xi/REF')
p.grid()
p.legend(frameon=False, loc=0)
p.savefig('2pcf_ratio.png')
p.clf()


p.figure(1, (5,5))
p.plot(REF[0], REF[0]*REF[0]*REF[1], label='ref')

DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.mask_O2O3Hb_th_1.5.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3Hb_th_1.5')
DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.mask_O2O3Hb_th_1.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3Hb_th_1')
DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.mask_O2O3Hb_th_2.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3Hb_th_2')

DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.mask_O2O3_th_1.5.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3_th_1.5')
DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.mask_O2O3_th_1.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3_th_1')
DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.mask_O2O3_th_2.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3_th_2')

DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.mask_O2_th_1.5.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2_th_1.5')
DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.mask_O2_th_1.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2_th_1')
DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.mask_O2_th_2.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2_th_2')

DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.O2O3Hb_th_3.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3Hb_th_3')
DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.O2O3_th_3.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3_th_3')
DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.O2_th_3.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2_th_3')


p.xscale('log')
#p.yscale('log')
p.xlabel('s Mpc/h')
p.ylabel(r'$s^2 \xi(s)$')
p.legend(frameon=False, loc=0)
p.grid()
p.savefig('2pcf_all.png')
p.clf()


p.figure(1, (5,5))
p.plot(REF[0], REF[1], label='ref', ls='dashed')


DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.mask_O2O3Hb_th_1.5.txt", unpack=True)
p.plot(REF[0],  DATA[1], label='O2O3Hb_th_1.5')
DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.mask_O2O3Hb_th_1.txt", unpack=True)
p.plot(REF[0],  DATA[1], label='O2O3Hb_th_1')
DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.mask_O2O3Hb_th_2.txt", unpack=True)
p.plot(REF[0],  DATA[1], label='O2O3Hb_th_2')

DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.mask_O2O3_th_1.5.txt", unpack=True)
p.plot(REF[0],  DATA[1], label='O2O3_th_1.5')
DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.mask_O2O3_th_1.txt", unpack=True)
p.plot(REF[0],  DATA[1], label='O2O3_th_1')
DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.mask_O2O3_th_2.txt", unpack=True)
p.plot(REF[0],  DATA[1], label='O2O3_th_2')

DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.mask_O2_th_1.5.txt", unpack=True)
p.plot(REF[0],  DATA[1], label='O2_th_1.5')
DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.mask_O2_th_1.txt", unpack=True)
p.plot(REF[0],  DATA[1], label='O2_th_1')
DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.mask_O2_th_2.txt", unpack=True)
p.plot(REF[0],  DATA[1], label='O2_th_2')

DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.O2O3Hb_th_3.txt", unpack=True)
p.plot(REF[0],  DATA[1], label='O2O3Hb_th_3')
DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.O2O3_th_3.txt", unpack=True)
p.plot(REF[0],  DATA[1], label='O2O3_th_3')
DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.O2_th_3.txt", unpack=True)
p.plot(REF[0],  DATA[1], label='O2_th_3')

p.xscale('log')
p.yscale('log')
p.xlim((0.2,5))
p.ylim((2,30))
p.xlabel('s Mpc/h')
p.ylabel(r'$\xi(s)$')
p.legend(frameon=False, loc=0)
p.grid()
p.savefig('2pcf_all_small_scales.png')
p.clf()

p.figure(1, (5,5))
p.plot(REF[0], REF[0]*REF[0]*REF[1], label='ref')

DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.mask_O2O3Hb_th_1.5.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3Hb_th_1.5')
DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.mask_O2O3Hb_th_1.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3Hb_th_1')
DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.mask_O2O3Hb_th_2.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3Hb_th_2')

DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.mask_O2O3_th_1.5.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3_th_1.5')
DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.mask_O2O3_th_1.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3_th_1')
DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.mask_O2O3_th_2.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3_th_2')

DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.mask_O2_th_1.5.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2_th_1.5')
DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.mask_O2_th_1.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2_th_1')
DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.mask_O2_th_2.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2_th_2')

DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.O2O3Hb_th_3.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3Hb_th_3')
DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.O2O3_th_3.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3_th_3')
DATA = n.loadtxt("ebosselg.JC28Nov2017_2pcf.O2_th_3.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2_th_3')

#p.xscale('log')
#p.yscale('log')
p.xlabel('s Mpc/h')
p.ylabel(r'$s^2 \xi(s)$')
p.legend(frameon=False, loc=0)
p.grid()
p.savefig('2pcf_all_lin.png')
p.clf()

REF = n.loadtxt("ebosselg.JC28Nov2017_linB2_2pcf", unpack=True)

p.figure(1, (5,5))
p.plot(REF[0], REF[0]*REF[0]*REF[1], label='ref')

DATA = n.loadtxt("ebosselg.JC28Nov2017_linB2_2pcf.mask_O2O3Hb_th_1.5.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3Hb_th_1.5')
DATA = n.loadtxt("ebosselg.JC28Nov2017_linB2_2pcf.mask_O2O3Hb_th_1.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3Hb_th_1')
DATA = n.loadtxt("ebosselg.JC28Nov2017_linB2_2pcf.mask_O2O3Hb_th_2.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3Hb_th_2')

DATA = n.loadtxt("ebosselg.JC28Nov2017_linB2_2pcf.mask_O2O3_th_1.5.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3_th_1.5')
DATA = n.loadtxt("ebosselg.JC28Nov2017_linB2_2pcf.mask_O2O3_th_1.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3_th_1')
DATA = n.loadtxt("ebosselg.JC28Nov2017_linB2_2pcf.mask_O2O3_th_2.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3_th_2')

DATA = n.loadtxt("ebosselg.JC28Nov2017_linB2_2pcf.mask_O2_th_1.5.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2_th_1.5')
DATA = n.loadtxt("ebosselg.JC28Nov2017_linB2_2pcf.mask_O2_th_1.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2_th_1')
DATA = n.loadtxt("ebosselg.JC28Nov2017_linB2_2pcf.mask_O2_th_2.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2_th_2')

DATA = n.loadtxt("ebosselg.JC28Nov2017_linB2_2pcf.O2O3Hb_th_3.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3Hb_th_3')
DATA = n.loadtxt("ebosselg.JC28Nov2017_linB2_2pcf.O2O3_th_3.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3_th_3')
DATA = n.loadtxt("ebosselg.JC28Nov2017_linB2_2pcf.O2_th_3.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2_th_3')

#p.xscale('log')
#p.yscale('log')
p.xlim((40,200))
p.ylim((-20,50))
p.xlabel('s Mpc/h')
p.ylabel(r'$s^2 \xi(s)$')
p.legend(frameon=False, loc=0)
p.grid()
p.savefig('2pcf_all_lin_linB2.png')
p.clf()


REF = n.loadtxt("ebosselg.JC28Nov2017_linB4_2pcf", unpack=True)

p.figure(1, (5,5))
p.plot(REF[0], REF[0]*REF[0]*REF[1], label='ref')

DATA = n.loadtxt("ebosselg.JC28Nov2017_linB4_2pcf.mask_O2O3Hb_th_1.5.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3Hb_th_1.5')
DATA = n.loadtxt("ebosselg.JC28Nov2017_linB4_2pcf.mask_O2O3Hb_th_1.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3Hb_th_1')
DATA = n.loadtxt("ebosselg.JC28Nov2017_linB4_2pcf.mask_O2O3Hb_th_2.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3Hb_th_2')

DATA = n.loadtxt("ebosselg.JC28Nov2017_linB4_2pcf.mask_O2O3_th_1.5.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3_th_1.5')
DATA = n.loadtxt("ebosselg.JC28Nov2017_linB4_2pcf.mask_O2O3_th_1.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3_th_1')
DATA = n.loadtxt("ebosselg.JC28Nov2017_linB4_2pcf.mask_O2O3_th_2.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3_th_2')

DATA = n.loadtxt("ebosselg.JC28Nov2017_linB4_2pcf.mask_O2_th_1.5.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2_th_1.5')
DATA = n.loadtxt("ebosselg.JC28Nov2017_linB4_2pcf.mask_O2_th_1.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2_th_1')
DATA = n.loadtxt("ebosselg.JC28Nov2017_linB4_2pcf.mask_O2_th_2.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2_th_2')

DATA = n.loadtxt("ebosselg.JC28Nov2017_linB4_2pcf.O2O3Hb_th_3.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3Hb_th_3')
DATA = n.loadtxt("ebosselg.JC28Nov2017_linB4_2pcf.O2O3_th_3.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3_th_3')
DATA = n.loadtxt("ebosselg.JC28Nov2017_linB4_2pcf.O2_th_3.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2_th_3')

#p.xscale('log')
#p.yscale('log')
p.xlim((40,200))
p.ylim((-20,50))
p.xlabel('s Mpc/h')
p.ylabel(r'$s^2 \xi(s)$')
p.legend(frameon=False, loc=0)
p.grid()
p.savefig('2pcf_all_lin_linB4.png')
p.clf()


p.figure(1, (5,5))
p.plot(REF[0], REF[0]*REF[0]*REF[1], label='ref')

DATA = n.loadtxt("ebosselg.JC28Nov2017_linB4_2pcf.mask_O2O3Hb_th_1.5.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3Hb_th_1.5')
DATA = n.loadtxt("ebosselg.JC28Nov2017_linB4_2pcf.mask_O2O3Hb_th_1.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3Hb_th_1')
DATA = n.loadtxt("ebosselg.JC28Nov2017_linB4_2pcf.mask_O2O3Hb_th_2.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3Hb_th_2')

DATA = n.loadtxt("ebosselg.JC28Nov2017_linB4_2pcf.mask_O2O3_th_1.5.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3_th_1.5')
DATA = n.loadtxt("ebosselg.JC28Nov2017_linB4_2pcf.mask_O2O3_th_1.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3_th_1')
DATA = n.loadtxt("ebosselg.JC28Nov2017_linB4_2pcf.mask_O2O3_th_2.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3_th_2')

DATA = n.loadtxt("ebosselg.JC28Nov2017_linB4_2pcf.mask_O2_th_1.5.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2_th_1.5')
DATA = n.loadtxt("ebosselg.JC28Nov2017_linB4_2pcf.mask_O2_th_1.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2_th_1')
DATA = n.loadtxt("ebosselg.JC28Nov2017_linB4_2pcf.mask_O2_th_2.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2_th_2')

DATA = n.loadtxt("ebosselg.JC28Nov2017_linB4_2pcf.O2O3Hb_th_3.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3Hb_th_3')
DATA = n.loadtxt("ebosselg.JC28Nov2017_linB4_2pcf.O2O3_th_3.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2O3_th_3')
DATA = n.loadtxt("ebosselg.JC28Nov2017_linB4_2pcf.O2_th_3.txt", unpack=True)
p.plot(REF[0],  REF[0]*REF[0]*DATA[1], label='O2_th_3')

#p.xscale('log')
#p.yscale('log')
p.xlim((10,140))
p.ylim((-20,50))
p.xlabel('s Mpc/h')
p.ylabel(r'$s^2 \xi(s)$')
p.legend(frameon=False, loc=0)
p.grid()
p.savefig('2pcf_all_lin_linB4_2.png')
p.clf()